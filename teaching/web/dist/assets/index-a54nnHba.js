import{c as t,I as k,_ as S,r as V,a as P,o as U,b as j,d as f,w as n,u as b,U as z,e as c,f as B,g as C,h as _,i as u}from"./index-9778kytf.js";var L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};function O(l){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?Object(arguments[r]):{},a=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),a.forEach(function(d){N(l,d,o[d])})}return l}function N(l,r,o){return r in l?Object.defineProperty(l,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):l[r]=o,l}var v=function(r,o){var a=O({},r,o.attrs);return t(k,O({},a,{icon:L}),null)};v.displayName="LockOutlined";v.inheritAttrs=!1;const H={class:"login-container"},M={class:"login-box"},q={class:"form-footer"},D={__name:"index",setup(l){const r=B(),o=V(!1),a=P({username:"",password:"",role:"student"}),d=async()=>{var p,e;try{o.value=!0;const s=await C.post("/login",a);s.data.success?(localStorage.setItem("role",s.data.role),localStorage.setItem("roleCode",s.data.roleCode),localStorage.setItem("userId",s.data.userId),localStorage.setItem("name",s.data.name),_.success("登录成功"),await r.push("/home")):_.error(s.data.message||"登录失败")}catch(s){console.error("登录错误:",s),_.error(((e=(p=s.response)==null?void 0:p.data)==null?void 0:e.message)||"登录失败，请检查网络连接")}finally{o.value=!1}};return(p,e)=>{const s=u("a-input"),m=u("a-form-item"),w=u("a-input-password"),g=u("a-radio"),x=u("a-radio-group"),y=u("a-button"),h=u("router-link"),I=u("a-form");return U(),j("div",H,[f("div",M,[e[8]||(e[8]=f("h2",null,"教学管理系统",-1)),t(I,{model:a,onFinish:d},{default:n(()=>[t(m,{name:"username",rules:[{required:!0,message:"请输入用户名"}]},{default:n(()=>[t(s,{value:a.username,"onUpdate:value":e[0]||(e[0]=i=>a.username=i),placeholder:"请输入用户名/学号/教工号"},{prefix:n(()=>[t(b(z))]),_:1},8,["value"])]),_:1}),t(m,{name:"password",rules:[{required:!0,message:"请输入密码"}]},{default:n(()=>[t(w,{value:a.password,"onUpdate:value":e[1]||(e[1]=i=>a.password=i),placeholder:"请输入密码"},{prefix:n(()=>[t(b(v))]),_:1},8,["value"])]),_:1}),t(m,{name:"role"},{default:n(()=>[t(x,{value:a.role,"onUpdate:value":e[2]||(e[2]=i=>a.role=i)},{default:n(()=>[t(g,{value:"student"},{default:n(()=>e[3]||(e[3]=[c("学生")])),_:1}),t(g,{value:"teacher"},{default:n(()=>e[4]||(e[4]=[c("教师")])),_:1})]),_:1},8,["value"])]),_:1}),t(m,null,{default:n(()=>[t(y,{type:"primary","html-type":"submit",block:"",loading:o.value},{default:n(()=>e[5]||(e[5]=[c(" 登录 ")])),_:1},8,["loading"])]),_:1}),f("div",q,[e[7]||(e[7]=c(" 还没有账号？ ")),t(h,{to:"/register"},{default:n(()=>e[6]||(e[6]=[c("去注册")])),_:1})])]),_:1},8,["model"])])])}}},A=S(D,[["__scopeId","data-v-264c2232"]]);export{A as default};
